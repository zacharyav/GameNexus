{"version":3,"sources":["/Users/darsh/github/repl-it-web/pkg/vite-plugin-dev-banner/dist/index.js","../src/dev-banner.ts","../package.json"],"names":[],"mappings":"AAAA;ACAA,2FAAe;AACf,0BAA8B;AAG9B,IAAM,iBAAA,EAAmB,kDAAA;AAElB,SAAS,SAAA,CAAA,EAAoB;AAClC,EAAA,IAAI,YAAA;AAEJ,EAAA,OAAO;AAAA,IACL,IAAA,EAAM,gCAAA;AAAA,IACN,OAAA,EAAS,KAAA;AAAA,IAET,MAAM,UAAA,CAAA,EAAa;AACjB,MAAA,MAAM,eAAA,EAAiB,gCAAA;AAAA,QACrB,IAAI,GAAA,CAAI,oBAAA,EAAsB,MAAA,CAAA,IAAA,CAAY,GAAG;AAAA,MAC/C,CAAA;AAEA,MAAA,IAAI;AACF,QAAA,aAAA,EAAe,MAAM,kBAAA,CAAG,QAAA,CAAS,cAAA,EAAgB,OAAO,CAAA;AAAA,MAC1D,EAAA,MAAA,CAAS,KAAA,EAAO;AAEd,QAAA,OAAA,CAAQ,KAAA;AAAA,UACN,mDAAA;AAAA,UACA;AAAA,QACF,CAAA;AAAA,MACF;AAAA,IACF,CAAA;AAAA,IAEA,eAAA,CAAgB,MAAA,EAAQ;AACtB,MAAA,MAAA,CAAO,WAAA,CAAY,GAAA,CAAI,CAAC,GAAA,EAAK,GAAA,EAAK,IAAA,EAAA,GAAS;AACzC,QAAA,GAAA,CAAI,GAAA,CAAI,IAAA,IAAQ,gBAAA,EAAkB;AAChC,UAAA,GAAA,CAAI,CAAC,YAAA,EAAc;AACjB,YAAA,GAAA,CAAI,WAAA,EAAa,GAAA;AACjB,YAAA,GAAA,CAAI,GAAA,CAAI,CAAA;AAER,YAAA,MAAA;AAAA,UACF;AAEA,UAAA,GAAA,CAAI,SAAA,CAAU,cAAA,EAAgB,wBAAwB,CAAA;AACtD,UAAA,GAAA,CAAI,GAAA,CAAI,YAAY,CAAA;AAEpB,UAAA,MAAA;AAAA,QACF;AAEA,QAAA,IAAA,CAAK,CAAA;AAAA,MACP,CAAC,CAAA;AAAA,IACH,CAAA;AAAA,IAEA,kBAAA,CAAmB,IAAA,EAAM,OAAA,EAAS;AAEhC,MAAA,GAAA,iBAAI,OAAA,mBAAQ,MAAA,6BAAQ,MAAA,qBAAO,UAAA,IAAY,OAAA,EAAS;AAC9C,QAAA,OAAO,IAAA;AAAA,MACT;AAEA,MAAA,OAAO;AAAA,QACL;AAAA,UACE,GAAA,EAAK,QAAA;AAAA,UACL,KAAA,EAAO;AAAA,YACL,IAAA,EAAM,iBAAA;AAAA,YACN,GAAA,EAAK,gBAAA;AAAA,YACL,EAAA,EAAI;AAAA,UACN,CAAA;AAAA,UACA,QAAA,EAAU;AAAA,QACZ;AAAA,MACF,CAAA;AAAA,IACF;AAAA,EACF,CAAA;AACF;ADbA;AACA;AEtDE,IAAA,QAAA,EAAW,OAAA;AFwDb;AACE;AACA;AACF,yDAAC","file":"/Users/darsh/github/repl-it-web/pkg/vite-plugin-dev-banner/dist/index.js","sourcesContent":[null,"import fs from 'fs/promises';\nimport { fileURLToPath } from 'url';\nimport type { Plugin } from 'vite';\n\nconst BANNER_SCRIPT_ID = '/@replit/vite-plugin-dev-banner/banner-script.js';\n\nexport function devBanner(): Plugin {\n  let bannerScript: string;\n\n  return {\n    name: '@replit/vite-plugin-dev-banner',\n    enforce: 'pre' as const,\n\n    async buildStart() {\n      const currentFileUrl = fileURLToPath(\n        new URL('./banner-script.js', import.meta.url),\n      );\n\n      try {\n        bannerScript = await fs.readFile(currentFileUrl, 'utf-8');\n      } catch (error) {\n        // eslint-disable-next-line no-console -- This is an error in the plugin\n        console.error(\n          '[replit-dev-banner] Failed to load banner script:',\n          error,\n        );\n      }\n    },\n\n    configureServer(server) {\n      server.middlewares.use((req, res, next) => {\n        if (req.url === BANNER_SCRIPT_ID) {\n          if (!bannerScript) {\n            res.statusCode = 404;\n            res.end();\n\n            return;\n          }\n\n          res.setHeader('Content-Type', 'application/javascript');\n          res.end(bannerScript);\n\n          return;\n        }\n\n        next();\n      });\n    },\n\n    transformIndexHtml(html, context) {\n      // Only inject in development mode\n      if (context.server?.config.command !== 'serve') {\n        return html;\n      }\n\n      return [\n        {\n          tag: 'script',\n          attrs: {\n            type: 'text/javascript',\n            src: BANNER_SCRIPT_ID,\n            id: 'replit-dev-banner',\n          },\n          injectTo: 'head',\n        },\n      ];\n    },\n  };\n}\n","{\n  \"name\": \"@replit/vite-plugin-dev-banner\",\n  \"version\": \"0.1.0\",\n  \"private\": false,\n  \"devDependencies\": {\n    \"@replit/tsconfig\": \"workspace:*\",\n    \"@types/node\": \"^22.5.5\",\n    \"@typescript-eslint/eslint-plugin\": \"^6.7.0\",\n    \"@typescript-eslint/parser\": \"^6.7.0\",\n    \"tsup\": \"^8.3.5\",\n    \"tsx\": \"^4.9.5\",\n    \"vite\": \"^5.4.10\"\n  },\n  \"main\": \"./src/index.ts\",\n  \"files\": [\n    \"src\"\n  ],\n  \"scripts\": {\n    \"build\": \"tsup\",\n    \"lint\": \"eslint src\",\n    \"format\": \"prettier --write \\\"src/**/*.ts\\\"\"\n  },\n  \"dependencies\": {}\n}\n"]}